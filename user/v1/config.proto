syntax = "proto3";

package user.v1;

import "enums/v1/user.proto";
import "google/protobuf/duration.proto";
import "huawei/v1/config.proto";
import "wechat/v1/config.proto";

message UserJwtConfig {
  // token签发者
  string issuer = 1;
  // 安全密钥
  string secret_key = 2;
  // 访问token有效时间
  google.protobuf.Duration access_ttl = 3;
  // 刷新token有效时间
  google.protobuf.Duration refresh_ttl = 4;
}

message AuthConfig {
  enums.v1.SignInType type = 1;
  huawei.v1.AccountConfig huawei = 2;
  wechat.v1.WechatConfig wechat = 3;
}

message UserConfig {
  string key_prefix = 1;
  int32 password_hasher_cost = 3;
  repeated AuthConfig auth = 4;
  UserJwtConfig jwt = 5;
  bool auto_migrate = 6;
}