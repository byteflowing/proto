syntax = "proto3";

package captcha.v1;

import "google/protobuf/duration.proto";
import "enums/v1/message.proto";
import "limiter/v1/limiter.proto";

message CaptchaProvider {
  enums.v1.MessageSenderType sender = 1;
  // 验证码的key前缀
  string prefix = 2;
  // 错误尝试次数的key前缀
  string err_prefix = 3;
  // 验证码保留时长
  google.protobuf.Duration keeping = 4;
  // 验证码是否大小写敏感
  bool case_sensitive = 5;
  // 验证码可以尝试多少次
  int32 err_try_limit = 6;
  // 验证码限流配置
  repeated limiter.v1.LimitRule limits = 7;
}

message Captcha {
  repeated CaptchaProvider providers = 1;
}
